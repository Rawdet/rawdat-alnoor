<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>المكتبة - روضة النور</title>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-database-compat.js"></script>

  <style>
    body {
      font-family: 'Arial', sans-serif;
      background-color: #f9f9f9;
      color: #333;
      margin: 0;
      padding: 0;
    }
    header {
      background-color: #4CAF50;
      color: white;
      text-align: center;
      padding: 1rem;
    }
    main {
      padding: 2rem;
      max-width: 900px;
      margin: auto;
    }
    .resource {
      background-color: #fff;
      margin-bottom: 1rem;
      padding: 1rem;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .resource h3 {
      margin-top: 0;
    }
    a.button {
      display: inline-block;
      margin-top: 2rem;
      color: #4CAF50;
      text-decoration: none;
      font-weight: bold;
    }
    .filter-buttons button {
      padding: 10px 20px;
      margin: 5px;
      border: none;
      background: linear-gradient(135deg, #f9a825, #f57c00);
      color: white;
      border-radius: 25px;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.3s ease, transform 0.2s ease;
    }
    .filter-buttons button:hover {
      background: linear-gradient(135deg, #f57c00, #ef6c00);
      transform: scale(1.05);
    }
  </style>
</head>
<body>
<header>
  <h1>المكتبة التعليمية</h1>
</header>

<main>
  <div class="filter-buttons" style="text-align: center; margin-bottom: 2rem;">
    <button onclick="filterCards('all')">الكل</button>
    <button onclick="filterCards('audio')">صوتيات</button>
    <button onclick="filterCards('pdf')">PDF</button>
    <button onclick="filterCards('video')">فيديوهات</button>
  </div>

  <!-- بطاقة صوتية -->
  <div class="resource" data-type="audio">
    <div style="position: relative;">
      <span style="background-color: #4CAF50; color: white; font-size: 12px; padding: 2px 6px; border-radius: 4px; position: absolute; top: -10px; left: -10px;">صوتي</span>
      <h3>🔊 سورة الفاتحة</h3>
    </div>
    <p>تحميل ملف صوتي لتعليم سورة الفاتحة.</p>
    <audio controls><source src="surat-al-fatihah-kids.mp3" type="audio/mpeg"/></audio>
    <a href="surat-al-fatihah-kids.mp3" onclick="incrementDownload('fatihah-audio')" style="display: inline-block; background-color: #4CAF50; color: white; padding: 10px 20px; border-radius: 8px; text-decoration: none; font-weight: bold;" target="_blank">⬇️ تحميل السورة</a>
    <p style="font-size: 12px; color: gray; margin-top: 5px;">📥 تم التحميل <span id="fatihah-audio-count">0</span> مرة</p>
  </div>

  <!-- بطاقة PDF -->
  <div class="resource" data-type="pdf">
    <div style="position: relative;">
      <span style="background-color: #2196F3; color: white; font-size: 12px; padding: 2px 6px; border-radius: 4px; position: absolute; top: -10px; left: -10px;">PDF</span>
      <h3>📚 بطاقات الحروف العربية</h3>
    </div>
    <p>مجموعة ملونة من البطاقات التعليمية لتعليم الحروف العربية بطريقة ممتعة.</p>
    <a href="arabic-cards-new.pdf" onclick="incrementDownload('arabic-cards-new')" style="display: inline-block; background-color: #2196F3; color: white; padding: 10px 20px; border-radius: 8px; text-decoration: none; font-weight: bold;" target="_blank">⬇️ تحميل البطاقات</a>
    <p style="font-size: 12px; color: gray; margin-top: 5px;">📥 تم التحميل <span id="arabic-cards-new-count">0</span> مرة</p>
  </div>

  <!-- بطاقة فيديو -->
  <div class="resource" data-type="video">
    <div style="position: relative;">
      <span style="background-color: #E53935; color: white; font-size: 12px; padding: 2px 6px; border-radius: 4px; position: absolute; top: -10px; left: -10px;">فيديو</span>
      <h3>🎥 حفظ سورة الفاتحة</h3>
    </div>
    <p>طريقة ممتعة لتحفيظ الأطفال سورة الفاتحة.</p>
    <video controls width="100%"><source src="fatihah-hifdh.mp4" type="video/mp4"/></video>
    <a href="fatihah-hifdh.mp4" onclick="incrementDownload('fatihah-hifdh')" style="display: inline-block; background-color: #E53935; color: white; padding: 10px 20px; margin-top: 10px; border-radius: 8px; text-decoration: none; font-weight: bold;" target="_blank">⬇️ تحميل السورة</a>
    <p style="font-size: 12px; color: gray; margin-top: 5px;">📥 تم التحميل <span id="fatihah-hifdh-count">0</span> مرة</p>
  </div>

  <a class="button" href="index.html">العودة إلى الصفحة الرئيسية</a>
</main>

<script>
  // إعداد Firebase باستخدام بياناتك الخاصة
  const firebaseConfig = {
    apiKey: "AIzaSyD5KwuW84A57kzyKOWZBi0JHfqFr90fcf4",
    authDomain: "rawdah-library.firebaseapp.com",
    databaseURL: "https://rawdah-library-default-rtdb.firebaseio.com", // هذا مهم!
    projectId: "rawdah-library",
    storageBucket: "rawdah-library.firebasestorage.app",
    messagingSenderId: "931349616439",
    appId: "1:931349616439:web:c7900b0b9c783a17666cb2"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  // تحميل العدادات تلقائيًا
  const counters = ["fatihah-audio", "arabic-cards-new", "fatihah-hifdh"];
  counters.forEach(key => {
    db.ref("downloads/" + key).on("value", snapshot => {
      document.getElementById(key + "-count").innerText = snapshot.val() || 0;
    });
  });

  // زيادة العدد عند التحميل
  function incrementDownload(key) {
    const ref = db.ref("downloads/" + key);
    ref.transaction(current => (current || 0) + 1);
  }

  // فلترة البطاقات
  function filterCards(type) {
    const cards = document.querySelectorAll(".resource");
    cards.forEach(card => {
      const cardType = card.getAttribute("data-type");
      card.style.display = (type === "all" || cardType === type) ? "block" : "none";
    });
  }
</script>
</body>
</html>
